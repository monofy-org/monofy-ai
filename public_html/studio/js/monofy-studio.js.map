{"version":3,"file":"monofy-studio.js","mappings":"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","sources":["webpack://monofy/webpack/bootstrap","webpack://monofy/webpack/runtime/make namespace object","webpack://monofy/../elements/src/EventObject.ts","webpack://monofy/../elements/src/managers/AudioManager.ts","webpack://monofy/./src/elements/components/AudioClock.ts","webpack://monofy/../elements/src/elements/WindowContainer.ts","webpack://monofy/../elements/src/elements/BaseElement.ts","webpack://monofy/../elements/src/elements/SizableElement.ts","webpack://monofy/../elements/src/elements/DraggableWindow.ts","webpack://monofy/./src/elements/components/AudioCursor.ts","webpack://monofy/./src/elements/components/PatternTrack.ts","webpack://monofy/./src/elements/windows/PatternWindow.ts","webpack://monofy/./src/elements/components/PlaylistTrack.ts","webpack://monofy/./src/elements/windows/PlaylistWindow.ts","webpack://monofy/./src/elements/Composition.ts","webpack://monofy/../elements/src/constants/audioConstants.ts","webpack://monofy/../elements/src/elements/AudioCanvas.ts","webpack://monofy/./src/elements/components/LyricCanvas.ts","webpack://monofy/../elements/src/DialogPopup.ts","webpack://monofy/./src/elements/audioDialogs.ts","webpack://monofy/./src/elements/components/Grid.ts","webpack://monofy/./src/elements/components/SideKeyboard.ts","webpack://monofy/./src/elements/components/PianoRoll.ts","webpack://monofy/./src/elements/windows/PianoRollWindow.ts","webpack://monofy/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export interface EventDataMap {\r\n  cancel: unknown;\r\n  start: unknown;\r\n  stop: unknown;\r\n  pause: unknown;\r\n  result: unknown;\r\n  update: unknown;\r\n  open: unknown;\r\n  close: unknown;\r\n  resize: unknown;\r\n  select: unknown;\r\n}\r\n\r\nexport type BaseEvent = keyof EventDataMap;\r\n\r\nexport default abstract class EventObject<E extends BaseEvent = BaseEvent> {\r\n  private _events: {\r\n    [eventName in E]?: ((e: EventDataMap[eventName]) => void)[];\r\n  } = {};\r\n  private _onceEvents: {\r\n    [eventName in E]?: ((e: EventDataMap[eventName]) => void)[];\r\n  } = {};\r\n\r\n  on(eventName: E, callback: (e: EventDataMap[E]) => void) {\r\n    if (!this._events[eventName]) {\r\n      this._events[eventName] = [];\r\n    }\r\n    this._events[eventName]!.push(callback);\r\n\r\n    return this;\r\n  }\r\n\r\n  once(eventName: E, callback: (e: EventDataMap[E]) => void) {\r\n    if (!this._onceEvents[eventName]) {\r\n      this._onceEvents[eventName] = [];\r\n    }\r\n    this._onceEvents[eventName]!.push(callback);\r\n\r\n    return this;\r\n  }\r\n\r\n  fireEvent(eventName: E, eventData?: EventDataMap[E]) {\r\n    const onceCallbacks = this._onceEvents[eventName];\r\n    if (onceCallbacks) {\r\n      for (const callback of onceCallbacks) {\r\n        try {\r\n          callback(eventData);\r\n        } catch (error) {\r\n          console.error(\r\n            `Error executing .once callback for event: ${eventName}`,\r\n            error\r\n          );\r\n        }\r\n      }\r\n      this._onceEvents[eventName] = undefined;\r\n    }\r\n\r\n    const callbacks = this._events[eventName];\r\n    if (callbacks) {\r\n      for (const callback of callbacks) {\r\n        try {\r\n          callback(eventData);\r\n        } catch (error) {\r\n          console.error(\r\n            `Error executing .on callback for event: ${eventName}`,\r\n            error\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","let audioContext: AudioContext | null = null;\r\n\r\nexport function getAudioContext() {\r\n  if (!audioContext) {\r\n    const AudioContext =\r\n      window.AudioContext || (window as any).webkitAudioContext;\r\n    audioContext = new AudioContext();\r\n\r\n    console.log(\"Audio context created\");\r\n\r\n    // force audio context to start\r\n    const buffer = audioContext.createBuffer(1, 1, audioContext.sampleRate);\r\n    const source = audioContext.createBufferSource();\r\n    source.buffer = buffer;\r\n    source.connect(audioContext.destination);\r\n    source.start(0);\r\n  }\r\n  return audioContext;\r\n}\r\n","import EventObject from \"../../../../elements/src/EventObject\";\r\nimport { getAudioContext } from \"../../../../elements/src/managers/AudioManager\";\r\n\r\nexport class AudioClock extends EventObject<\r\n  \"start\" | \"stop\" | \"pause\" | \"update\"\r\n> {\r\n  domElement: HTMLDivElement;\r\n  bpmInput: HTMLInputElement;\r\n  playPauseButton: HTMLButtonElement;\r\n  stopButton: HTMLButtonElement;\r\n  currentTimeDisplay: HTMLSpanElement;\r\n  private _isPlaying: boolean = false;\r\n  private _bpm: number = 100;\r\n  private startTime: number | null = null;\r\n\r\n  get currentBeat(): number {\r\n    const elapsedTime =\r\n      this.startTime !== null\r\n        ? getAudioContext().currentTime - this.startTime\r\n        : 0;\r\n    return elapsedTime * (this._bpm / 60);\r\n  }\r\n\r\n  get isPlaying(): boolean {\r\n    return this._isPlaying;\r\n  }\r\n\r\n  get bpm(): number {\r\n    return this._bpm;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"audio-clock\");\r\n\r\n    this.playPauseButton = document.createElement(\"button\");\r\n    this.playPauseButton.classList.add(\"audio-clock-play-pause\");\r\n    this.playPauseButton.textContent = \"Play\";\r\n\r\n    this.playPauseButton.addEventListener(\"click\", () => {\r\n      if (this._isPlaying) {\r\n        this.stop();\r\n      } else {\r\n        getAudioContext();\r\n        this.play();\r\n      }\r\n    });\r\n    this.domElement.appendChild(this.playPauseButton);\r\n    this.stopButton = document.createElement(\"button\");\r\n    this.stopButton.classList.add(\"audio-clock-stop\");\r\n    this.stopButton.textContent = \"Stop\";\r\n\r\n    this.stopButton.addEventListener(\"click\", () => {\r\n      this.stop();\r\n    });\r\n    this.domElement.appendChild(this.stopButton);\r\n\r\n    this.bpmInput = document.createElement(\"input\");\r\n    this.bpmInput.classList.add(\"audio-clock-bpm\");\r\n    this.bpmInput.type = \"number\";\r\n    this.bpmInput.value = \"120\";\r\n\r\n    this.bpmInput.addEventListener(\"input\", () => {\r\n      this._bpm = parseFloat(this.bpmInput.value);\r\n    });\r\n    this.domElement.appendChild(this.bpmInput);\r\n\r\n    this.currentTimeDisplay = document.createElement(\"span\");\r\n    this.currentTimeDisplay.classList.add(\"audio-clock-time\");\r\n    this.currentTimeDisplay.textContent = \"01:1\";\r\n\r\n    this.domElement.appendChild(this.currentTimeDisplay);\r\n  }\r\n\r\n  private start(): void {\r\n    this.fireEvent(\"start\");\r\n    this.startTime = getAudioContext().currentTime;\r\n    console.log(\"Started at\", this.startTime);\r\n    requestAnimationFrame(this.render.bind(this));\r\n  }\r\n\r\n  private render(): void {\r\n    this.updateCurrentTimeDisplay(this.currentBeat);\r\n    this.fireEvent(\"update\");\r\n    if (this._isPlaying) requestAnimationFrame(this.render.bind(this));\r\n  }\r\n\r\n  private stop(): void {\r\n    this.fireEvent(\"stop\");\r\n    this._isPlaying = false;\r\n    this.startTime = null;\r\n    this.updateCurrentTimeDisplay(this.currentBeat);\r\n    this.playPauseButton.textContent = \"Play\";\r\n  }\r\n\r\n  private play(): void {\r\n    if (this._isPlaying) {\r\n      this.stop(); // TODO: This should be a pause\r\n    } else {\r\n      this.start();\r\n    }\r\n    this._isPlaying = !this._isPlaying;\r\n    this.playPauseButton.textContent = this._isPlaying ? \"Pause\" : \"Play\";\r\n  }\r\n\r\n  private updateCurrentTimeDisplay(beat: number): void {\r\n    const bars = Math.floor(beat / 4) + 1;\r\n    const beats = Math.floor(beat % 4) + 1;\r\n    const timeString = `${bars\r\n      .toString()\r\n      .padStart(2, \"0\")}:${beats.toString()}`;\r\n    this.currentTimeDisplay.textContent = timeString;\r\n  }\r\n}\r\n","import { EventDataMap } from \"../EventObject\";\r\nimport { DraggableWindow } from \"./DraggableWindow\";\r\n\r\nexport class WindowContainer {\r\n  readonly domElement: HTMLDivElement;\r\n\r\n  windows: DraggableWindow<keyof EventDataMap>[] = [];\r\n  _draggingWindow: DraggableWindow<keyof EventDataMap> | null = null;\r\n\r\n  constructor() {\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.className = \"window-container\";\r\n    this.domElement.addEventListener(\"pointerdown\", () => {});\r\n  }\r\n\r\n  addWindow<T extends DraggableWindow<keyof EventDataMap>>(window: T) {\r\n    this.windows.push(window);\r\n    this.domElement.appendChild(window.domElement);\r\n  }\r\n}\r\n","import EventObject, { EventDataMap } from \"../EventObject\";\r\n\r\nexport abstract class BaseElement<\r\n  T extends keyof EventDataMap,\r\n> extends EventObject<T> {\r\n  domElement: HTMLElement;\r\n\r\n  constructor(tagName: string, className?: string) {\r\n    super();\r\n    console.log(\"BaseElement constructor\");\r\n    this.domElement = document.createElement(tagName);\r\n    if (className) {\r\n      this.domElement.classList.add(className);\r\n    }\r\n  }\r\n}\r\n","import { EventDataMap } from \"../EventObject\";\r\nimport { BaseElement } from \"./BaseElement\";\r\n\r\nexport abstract class SizableElement<\r\n  T extends keyof EventDataMap,\r\n> extends BaseElement<\"resize\" | T> {\r\n  private _resizing = false;\r\n  private _startX = 0;\r\n  private _startY = 0;\r\n  private _startWidth = 0;\r\n  private _startHeight = 0;\r\n  private _startTop = 0;\r\n  private _startLeft = 0;\r\n\r\n  private _resizeDirection: \"top\" | \"right\" | \"bottom\" | \"left\" | null = null;\r\n\r\n  constructor(tagName: string, className?: string) {\r\n    super(tagName, className);\r\n\r\n    this.domElement.addEventListener(\"pointermove\", (e) => {\r\n      const handle = this.getCurrentHandle(e);\r\n      if (handle === \"top\" || handle === \"bottom\") {\r\n        this.domElement.style.cursor = \"ns-resize\";\r\n      } else if (handle === \"left\" || handle === \"right\") {\r\n        this.domElement.style.cursor = \"ew-resize\";\r\n      } else {\r\n        this.domElement.style.cursor = \"auto\";\r\n      }\r\n    });\r\n\r\n    const onmove = (e: PointerEvent) => {\r\n      if (this._resizing) {\r\n        console.log(this._resizeDirection);\r\n\r\n        const dx = e.clientX - this._startX;\r\n        const dy = e.clientY - this._startY;\r\n\r\n        if (this._resizeDirection === \"right\") {\r\n          this.domElement.style.width = `${this._startWidth + dx}px`;\r\n        } else if (this._resizeDirection === \"bottom\") {\r\n          this.domElement.style.height = `${this._startHeight + dy}px`;\r\n        } else if (this._resizeDirection === \"left\") {\r\n          this.domElement.style.width = `${this._startWidth - dx}px`;\r\n          this.domElement.style.left = `${this._startLeft + dx}px`;\r\n        } else if (this._resizeDirection === \"top\") {\r\n          this.domElement.style.height = `${this._startHeight - dy}px`;\r\n          this.domElement.style.top = `${this._startTop + dy}px`;\r\n        }\r\n\r\n        this.fireEvent(\"resize\", {\r\n          width: this.domElement.offsetWidth,\r\n          height: this.domElement.offsetHeight,\r\n        });\r\n      }\r\n    };\r\n\r\n    this.domElement.addEventListener(\"pointerdown\", (e) => {\r\n      e.preventDefault();\r\n      const handle = this.getCurrentHandle(e);\r\n      if (handle) {\r\n        window.addEventListener(\"pointermove\", onmove);\r\n        this.startResize(e, handle);\r\n      }\r\n      const onrelease = () => {\r\n        this.stopResize();\r\n        window.removeEventListener(\"pointermove\", onmove);\r\n        window.removeEventListener(\"pointerup\", onrelease);\r\n      };\r\n\r\n      window.addEventListener(\"pointerup\", onrelease);\r\n    });\r\n  }\r\n\r\n  protected startResize(\r\n    e: PointerEvent,\r\n    direction: \"top\" | \"right\" | \"bottom\" | \"left\"\r\n  ) {\r\n    console.log(\"startResize\", direction);\r\n    this._resizing = true;\r\n    this._startX = e.clientX;\r\n    this._startY = e.clientY;\r\n    this._startWidth = this.domElement.offsetWidth;\r\n    this._startHeight = this.domElement.offsetHeight;\r\n    this._startTop = this.domElement.offsetTop;\r\n    this._startLeft = this.domElement.offsetLeft;\r\n    this._resizeDirection = direction;\r\n  }\r\n\r\n  protected stopResize() {\r\n    this._resizing = false;\r\n    this._resizeDirection = null;\r\n  }\r\n\r\n  getCurrentHandle(e: PointerEvent) {\r\n    const rect = this.domElement.getBoundingClientRect();\r\n    const offsetX = e.clientX - rect.left;\r\n    const offsetY = e.clientY - rect.top;\r\n\r\n    if (offsetX > 0 && offsetX < 10) {\r\n      return \"left\";\r\n    } else if (rect.width - offsetX < 10) {\r\n      return \"right\";\r\n    } else if (offsetY > 0 && offsetY < 10) {\r\n      return \"top\";\r\n    } else if (rect.height - offsetY < 10) {\r\n      return \"bottom\";\r\n    }\r\n    return null;\r\n  }\r\n}\r\n","import { EventDataMap } from \"../EventObject\";\r\nimport { SizableElement } from \"./SizableElement\";\r\n\r\nexport class DraggableWindow<\r\n  T extends keyof EventDataMap,\r\n> extends SizableElement<\"update\" | \"resize\" | \"open\" | \"close\" | T> {\r\n  readonly titlebar: HTMLElement;\r\n  readonly content: HTMLElement;\r\n  private readonly _title: HTMLElement;\r\n  private readonly _closeButton: HTMLButtonElement;\r\n  private _isDragging = false;\r\n  private _dragOffsetX = 0;\r\n  private _dragOffsetY = 0;\r\n  private _top = 0;\r\n  private _left = 0;\r\n\r\n  get isVisible() {\r\n    return this.domElement.style.display !== \"none\";\r\n  }\r\n\r\n  constructor(\r\n    title: string,\r\n    private readonly persistent = false,\r\n    private innerContent: HTMLElement\r\n  ) {\r\n    super(\"div\", \"draggable-window\");\r\n\r\n    this.domElement.addEventListener(\"pointerdown\", () => {\r\n      this.domElement.parentElement!.appendChild(this.domElement);\r\n    });\r\n\r\n    this.titlebar = document.createElement(\"div\");\r\n    this.titlebar.className = \"window-titlebar\";\r\n    this.domElement.appendChild(this.titlebar);\r\n\r\n    this.titlebar.addEventListener(\"pointerdown\", (e) => {\r\n      this._isDragging = true;\r\n      this._dragOffsetX =\r\n        e.clientX - this.domElement.getBoundingClientRect().left;\r\n      this._dragOffsetY =\r\n        e.clientY -\r\n        this.domElement.getBoundingClientRect().top +\r\n        this.domElement.parentElement!.getBoundingClientRect().top +\r\n        this.domElement.parentElement!.scrollTop;\r\n\r\n      const ondrag = (e: PointerEvent) => {\r\n        if (this._isDragging) {\r\n          console.log(\"Dragging\");\r\n\r\n          let newTop = e.clientY - this._dragOffsetY;\r\n          let newLeft = e.clientX - this._dragOffsetX;\r\n\r\n          if (newTop < 0) {\r\n            newTop = 0;\r\n          }\r\n\r\n          if (newLeft < 0) {\r\n            newLeft = 0;\r\n          }\r\n\r\n          this.domElement.style.top = `${newTop}px`;\r\n          this.domElement.style.left = `${newLeft}px`;\r\n\r\n          this._top = newTop;\r\n          this._left = newLeft;\r\n        }\r\n      };\r\n\r\n      const onrelease = () => {\r\n        this._isDragging = false;\r\n        document.body.removeEventListener(\"pointermove\", ondrag);\r\n        document.body.removeEventListener(\"pointerup\", onrelease);\r\n      };\r\n\r\n      document.body.addEventListener(\"pointermove\", ondrag);\r\n      document.body.addEventListener(\"pointerup\", onrelease);\r\n    });\r\n\r\n    this._title = document.createElement(\"div\");\r\n    this._title.className = \"window-titlebar-title\";\r\n    this._title.textContent = title;\r\n    this.titlebar.appendChild(this._title);\r\n\r\n    this.content = document.createElement(\"div\");\r\n    this.content.className = \"window-content\";\r\n    this.domElement.appendChild(this.content);\r\n\r\n    this._closeButton = document.createElement(\"button\");\r\n    this._closeButton.className = \"window-close-button\";\r\n    this._closeButton.innerHTML = \"X\";\r\n    this._closeButton.addEventListener(\"pointerdown\", () => {\r\n      this.close();\r\n    });\r\n\r\n    this.titlebar.appendChild(this._closeButton);\r\n\r\n    this.content.appendChild(this.innerContent);\r\n  }\r\n\r\n  show(x?: number, y?: number) {\r\n    this.domElement.style.display = \"flex\";\r\n    if (y) this.domElement.style.top = `${y}px`;\r\n    if (x) this.domElement.style.left = `${x}px`;\r\n    setTimeout(() => {\r\n      this.domElement.parentElement?.appendChild(this.domElement);\r\n      this.fireEvent(\"open\");\r\n    }, 1);    \r\n  }\r\n\r\n  close() {\r\n    this.domElement.style.display = \"none\";\r\n    this.fireEvent(\"close\");\r\n    if (!this.persistent) {\r\n      this.domElement.remove();\r\n    }\r\n  }\r\n\r\n  setSize(width: number, height: number) {\r\n    this.domElement.style.width = `${width}px`;\r\n    this.domElement.style.height = `${height}px`;\r\n  }\r\n\r\n  setPosition(x: number, y: number) {\r\n    this.domElement.style.top = `${y}px`;\r\n    this.domElement.style.left = `${x}px`;\r\n  }\r\n\r\n  setTitle(title: string) {\r\n    this._title.textContent = title;\r\n  }\r\n}\r\n","import { ICursorTimeline } from \"../ICursorTimeline\";\r\nimport { AudioClock } from \"./AudioClock\";\r\n\r\nexport class AudioCursor {\r\n  readonly domElement: HTMLDivElement;\r\n\r\n  constructor(\r\n    readonly audioClock: AudioClock,\r\n    readonly container: ICursorTimeline,\r\n  ) {\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"audio-cursor\");\r\n\r\n    audioClock.on(\"update\", () => {\r\n      this.update();\r\n    });\r\n  }\r\n\r\n  update() {\r\n    // Update the cursor position\r\n  }\r\n}\r\n","import { BaseElement } from \"../../../../elements/src/elements/BaseElement\";\r\nimport { ISequence } from \"../../schema\";\r\nimport { GridItem } from \"./Grid\";\r\n\r\nexport class PatternTrack\r\n  extends BaseElement<\"update\" | \"select\">\r\n  implements ISequence\r\n{\r\n  private _canvas: HTMLCanvasElement;\r\n  private _name: string = \"\";\r\n\r\n  get canvas() {\r\n    return this._canvas;\r\n  }\r\n\r\n  get name() {\r\n    return this._name;\r\n  }\r\n\r\n  constructor(\r\n    name: string,\r\n    readonly events: GridItem[]\r\n  ) {\r\n    super(\"div\", \"pattern-track\");\r\n\r\n    const instrumentPanel = document.createElement(\"div\");\r\n    instrumentPanel.classList.add(\"pattern-track-panel\");\r\n\r\n    const label = document.createElement(\"div\");\r\n    instrumentPanel.appendChild(label);\r\n    label.textContent = name;\r\n\r\n    const buttons = document.createElement(\"div\");\r\n    buttons.classList.add(\"pattern-track-buttons\");\r\n    instrumentPanel.appendChild(buttons);\r\n\r\n    const edit = document.createElement(\"button\");\r\n    edit.textContent = \"e\";\r\n    buttons.appendChild(edit);\r\n\r\n    const mute = document.createElement(\"button\");\r\n    mute.textContent = \"M\";\r\n    buttons.appendChild(mute);\r\n\r\n    const solo = document.createElement(\"button\");\r\n    solo.textContent = \"S\";\r\n    buttons.appendChild(solo);\r\n\r\n    const indicator = document.createElement(\"div\");\r\n    indicator.classList.add(\"pattern-track-indicator\");\r\n    buttons.appendChild(indicator);\r\n\r\n    buttons.appendChild(mute);\r\n    buttons.appendChild(solo);\r\n\r\n    this._canvas = document.createElement(\"canvas\");\r\n    this._canvas.height = 100;\r\n    this._canvas.width = 1600;\r\n    this._canvas.classList.add(\"pattern-track-pattern\");\r\n\r\n    this._canvas.addEventListener(\"pointerdown\", () => {\r\n      this.fireEvent(\"select\", this);\r\n    });\r\n\r\n    this.domElement.appendChild(instrumentPanel);\r\n    this.domElement.appendChild(indicator);\r\n    this.domElement.appendChild(this._canvas);\r\n  }\r\n}\r\n","import { DraggableWindow } from \"../../../../elements/src/elements/DraggableWindow\";\r\nimport { Composition } from \"../Composition\";\r\nimport { AudioClock } from \"../components/AudioClock\";\r\nimport { AudioCursor } from \"../components/AudioCursor\";\r\nimport { GridItem } from \"../components/Grid\";\r\nimport { PatternTrack } from \"../components/PatternTrack\";\r\nimport { ICursorTimeline } from \"../ICursorTimeline\";\r\n\r\nexport class PatternWindow\r\n  extends DraggableWindow<\"select\">\r\n  implements ICursorTimeline\r\n{\r\n  readonly timeline: HTMLDivElement;\r\n  readonly cursor: AudioCursor;\r\n  readonly tracks: PatternTrack[] = [];\r\n\r\n  constructor(\r\n    readonly audioClock: AudioClock,\r\n    readonly composition: Composition\r\n  ) {\r\n    const container = document.createElement(\"div\");\r\n    container.classList.add(\"pattern-track-container\");\r\n\r\n    super(\"Pattern\", true, container);\r\n    this.timeline = container;\r\n    this.setSize(800, 400);\r\n\r\n    this.cursor = new AudioCursor(audioClock, this);\r\n  }\r\n\r\n  addTrack(name: string, events: GridItem[] = []) {\r\n    const track = new PatternTrack(name, events);\r\n\r\n    track.on(\"select\", (selectedTrack) => {\r\n      this.fireEvent(\"select\", selectedTrack);\r\n    });\r\n    this.tracks.push(track);\r\n    this.timeline.appendChild(track.domElement);\r\n\r\n    return track;\r\n  }\r\n\r\n  removeTrack(track: PatternTrack) {\r\n    const index = this.tracks.indexOf(track);\r\n    if (index !== -1) {\r\n      this.tracks.splice(index, 1);\r\n      this.timeline.removeChild(track.domElement);\r\n    }\r\n  }\r\n}\r\n","import { BaseElement } from \"../../../../elements/src/elements/BaseElement\";\r\n\r\nexport class PlaylistTrack extends BaseElement<\"update\"> {\r\n  constructor(name: string) {\r\n    super(\"div\", \"playlist-track\");\r\n\r\n    const settings = document.createElement(\"div\");\r\n    settings.classList.add(\"instrument-panel\");\r\n\r\n    const label = document.createElement(\"div\");\r\n    settings.appendChild(label);\r\n    label.textContent = name;\r\n\r\n    const buttons = document.createElement(\"div\");\r\n    buttons.classList.add(\"playlist-track-selector\");\r\n    settings.appendChild(buttons);\r\n\r\n    const mute = document.createElement(\"button\");\r\n    mute.textContent = \"M\";\r\n    buttons.appendChild(mute);\r\n\r\n    const solo = document.createElement(\"button\");\r\n    solo.textContent = \"S\";\r\n    buttons.appendChild(solo);\r\n\r\n    const track = document.createElement(\"div\");\r\n    track.classList.add(\"pattern-panel\");\r\n\r\n    this.domElement.appendChild(settings);\r\n    this.domElement.appendChild(track);\r\n  }\r\n}\r\n","import { DraggableWindow } from \"../../../../elements/src/elements/DraggableWindow\";\r\nimport { Composition } from \"../Composition\";\r\nimport { PlaylistTrack } from \"../components/PlaylistTrack\";\r\nimport { AudioClock } from \"../components/AudioClock\";\r\n\r\nexport class PlaylistWindow extends DraggableWindow<\"update\" | \"select\"> {\r\n  private _trackContainer: HTMLDivElement;\r\n  private _tracks: PlaylistTrack[] = [];\r\n  private cursor: HTMLDivElement;\r\n\r\n  constructor(\r\n    readonly clock: AudioClock,\r\n    readonly composition: Composition\r\n  ) {\r\n    const container = document.createElement(\"div\");\r\n    container.classList.add(\"playlist-track-container\");\r\n\r\n    super(\"Playlist\", true, container);\r\n    this._trackContainer = container;\r\n    this.setSize(800, 400);\r\n\r\n    this.cursor = document.createElement(\"div\");\r\n    this.cursor.classList.add(\"piano-roll-cursor\");\r\n    this.cursor.style.display = \"none\";\r\n    this._trackContainer.appendChild(this.cursor);\r\n\r\n    clock.on(\"update\", () => {\r\n      this.updateCursor();\r\n    });\r\n  }\r\n\r\n  addTrack(name: string) {\r\n    const track = new PlaylistTrack(name);\r\n    this._tracks.push(track);\r\n    this._trackContainer.appendChild(track.domElement);\r\n    this._trackContainer.appendChild(this.cursor);\r\n  }\r\n\r\n  updateCursor() {\r\n    if (this.clock.isPlaying) {\r\n      this.cursor.style.transform = `translateX(${\r\n        (this.clock.currentBeat * this._trackContainer.offsetWidth) / 16\r\n      }px)`;\r\n    }\r\n  }\r\n}\r\n","import { IPattern, IProject, ITimelineSequence } from \"../schema\";\r\n\r\nexport class Composition implements IProject {\r\n  title: string;\r\n  description: string;\r\n  tempo: number;\r\n  patterns: IPattern[] = [];\r\n  timeline: ITimelineSequence[] = [];\r\n\r\n  constructor() {\r\n    this.title = \"Untitled\";\r\n    this.description = \"No description\";\r\n    this.tempo = 120;\r\n  }\r\n\r\n  serialize(): string {\r\n    return JSON.stringify(this);\r\n  }\r\n}\r\n","export const DEFAULT_NOTE_HEIGHT = 20;\r\n\r\nexport const KEY_COLORS = [\r\n  \"white\",\r\n  \"black\",\r\n  \"white\",\r\n  \"white\",\r\n  \"black\",\r\n  \"white\",\r\n  \"black\",\r\n  \"white\",\r\n  \"white\",\r\n  \"black\",\r\n  \"white\",\r\n  \"black\",\r\n];\r\n\r\nexport const NOTE_NAMES = [\r\n  \"A\",\r\n  \"A#\",\r\n  \"B\",\r\n  \"C\",\r\n  \"C#\",\r\n  \"D\",\r\n  \"D#\",\r\n  \"E\",\r\n  \"F\",\r\n  \"F#\",\r\n  \"G\",\r\n  \"G#\",\r\n];\r\n","import { getAudioContext } from \"../../../elements/src/managers/AudioManager\";\r\n\r\nexport class AudioCanvas {\r\n  domElement: HTMLDivElement;\r\n  canvas: HTMLCanvasElement;\r\n  ctx: CanvasRenderingContext2D;\r\n  buffer: AudioBuffer | null = null;\r\n\r\n  constructor() {\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"audio-canvas\");\r\n\r\n    this.canvas = document.createElement(\"canvas\");\r\n    this.canvas.width = 800;\r\n    this.canvas.height = 200;\r\n    this.domElement.appendChild(this.canvas);\r\n\r\n    this.canvas.addEventListener(\"click\", () => {\r\n      if (this.buffer) {\r\n        this.playBuffer(this.buffer);\r\n      }\r\n    });\r\n\r\n    this.ctx = this.canvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n  }\r\n\r\n  async generateAudio(\r\n    note: { label: string; note: number },\r\n    preview: boolean = false\r\n  ): Promise<AudioBuffer> {\r\n    const buffer: AudioBuffer = await new Promise((resolve, reject) => {\r\n      const req = {\r\n        text: note.label,\r\n        pitch: note.note,\r\n        rate: 0.9,\r\n      };\r\n      fetch(\"/api/tts/edge\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify(req),\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n      })\r\n        .then((res) => res.arrayBuffer())\r\n        .then((data) => {\r\n          console.log(\"Audio buffer downloaded\", data);\r\n          getAudioContext().decodeAudioData(\r\n            data,\r\n            (audioBuffer: AudioBuffer) => {\r\n              this.buffer = audioBuffer;\r\n              if (preview) {\r\n                this.playBuffer(audioBuffer);\r\n              }\r\n\r\n              resolve(audioBuffer);\r\n            }\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Error downloading audio buffer\", error);\r\n          reject(error);\r\n        });\r\n    });\r\n\r\n    this.loadBuffer(buffer);\r\n\r\n    return buffer;\r\n  }\r\n\r\n  playBuffer(audioBuffer: AudioBuffer) {\r\n    const ctx = getAudioContext();\r\n    const source = ctx.createBufferSource();\r\n    source.buffer = audioBuffer;\r\n    source.connect(ctx.destination);\r\n    source.start();\r\n  }\r\n\r\n  loadBuffer(audioBuffer: AudioBuffer) {\r\n    this.buffer = audioBuffer;\r\n\r\n    const channelData = audioBuffer.getChannelData(0);\r\n    const bufferLength = channelData.length;\r\n    const sliceWidth = this.canvas.width / bufferLength;\r\n\r\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(0, this.canvas.height / 2);\r\n\r\n    for (let i = 0; i < bufferLength; i++) {\r\n      const x = i * sliceWidth;\r\n      const y = ((channelData[i] + 1) * this.canvas.height) / 2;\r\n\r\n      this.ctx.lineTo(x, y);\r\n    }\r\n\r\n    this.ctx.lineTo(this.canvas.width, this.canvas.height / 2);\r\n    this.ctx.stroke();\r\n  }\r\n}\r\n","import { getAudioContext } from \"../../../../elements/src/managers/AudioManager\";\r\nimport { AudioCanvas } from \"../../../../elements/src/elements/AudioCanvas\";\r\n\r\nexport class LyricCanvas extends AudioCanvas {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  async generateAudio(\r\n    note: { label: string; note: number },\r\n    preview: boolean = false\r\n  ): Promise<AudioBuffer> {\r\n    const buffer: AudioBuffer = await new Promise((resolve, reject) => {\r\n      const req = {\r\n        text: note.label,\r\n        pitch: note.note,\r\n        rate: 0.9,\r\n      };\r\n      fetch(\"/api/tts/edge\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify(req),\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n      })\r\n        .then((res) => res.arrayBuffer())\r\n        .then((data) => {\r\n          console.log(\"Audio buffer downloaded\", data);\r\n          getAudioContext().decodeAudioData(\r\n            data,\r\n            (audioBuffer: AudioBuffer) => {\r\n              this.buffer = audioBuffer;\r\n              if (preview) {\r\n                this.playBuffer(audioBuffer);\r\n              }\r\n\r\n              resolve(audioBuffer);\r\n            }\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Error downloading audio buffer\", error);\r\n          reject(error);\r\n        });\r\n    });\r\n\r\n    this.loadBuffer(buffer);\r\n\r\n    return buffer;\r\n  }\r\n}\r\n","import EventObject from \"./EventObject\";\r\n\r\nexport class DialogPopup extends EventObject<\"result\" | \"cancel\"> {\r\n  domElement: HTMLDivElement;\r\n  closeButton: HTMLButtonElement;\r\n  okButton: HTMLButtonElement | undefined;\r\n  cancelButton: HTMLButtonElement | undefined;\r\n\r\n  get isVisibile() {\r\n    return this.domElement.style.display !== \"none\";\r\n  }\r\n\r\n  constructor(\r\n    private readonly ok: string | HTMLButtonElement = \"OK\",\r\n    private readonly cancel: string | HTMLButtonElement = \"Cancel\"\r\n  ) {\r\n    super();\r\n\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"dialog-popup\");\r\n\r\n    this.closeButton = document.createElement(\"button\");\r\n    this.closeButton.textContent = \"X\";\r\n    this.domElement.appendChild(this.closeButton);\r\n    this.closeButton.addEventListener(\"click\", () => {\r\n      this.domElement.style.display = \"none\";\r\n    });\r\n\r\n    if (ok instanceof HTMLButtonElement) {\r\n      this.okButton = ok;\r\n    } else if (ok) {\r\n      this.okButton = document.createElement(\"button\");\r\n      this.okButton.textContent = ok;\r\n      this.domElement.appendChild(this.okButton);\r\n    }\r\n\r\n    if (this.okButton) {\r\n      this.okButton.addEventListener(\"click\", () => {\r\n        this.fireEvent(\"result\", this);\r\n      });\r\n    }\r\n\r\n    if (cancel instanceof HTMLButtonElement) {\r\n      this.cancelButton = cancel;\r\n    } else if (cancel) {\r\n      this.cancelButton = document.createElement(\"button\");\r\n      this.cancelButton.textContent = cancel;\r\n      this.domElement.appendChild(this.cancelButton);\r\n    }\r\n\r\n    if (this.cancelButton) {\r\n      this.cancelButton.addEventListener(\"click\", () => {\r\n        this.fireEvent(\"cancel\", this);\r\n      });\r\n    }\r\n  }\r\n\r\n  show(x: number, y: number, targetObject?: unknown) { /* eslint-disable-line @typescript-eslint/no-unused-vars */\r\n    this.domElement.style.display = \"block\";\r\n    this.domElement.style.left = `${x}px`;\r\n    this.domElement.style.top = `${y}px`;\r\n    this.domElement.parentElement?.appendChild(this.domElement);\r\n  }\r\n\r\n  hide() {\r\n    this.domElement.style.display = \"none\";\r\n  }\r\n}\r\n","import { LyricCanvas } from \"./components/LyricCanvas\";\r\nimport { GridItem } from \"./components/Grid\";\r\nimport { DialogPopup } from \"../../../elements/src/DialogPopup\";\r\n\r\nexport class PianoRollDialog extends DialogPopup {\r\n  domElement: HTMLDivElement;\r\n  closeButton: HTMLButtonElement;\r\n  saveButton: HTMLButtonElement;\r\n  note: GridItem | null = null;\r\n\r\n  constructor(public onsave: (note: GridItem) => void) {\r\n    super();\r\n\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"piano-roll-dialog\");\r\n\r\n    this.closeButton = document.createElement(\"button\");\r\n    this.closeButton.textContent = \"X\";\r\n    this.domElement.appendChild(this.closeButton);\r\n    this.closeButton.addEventListener(\"click\", () => {\r\n      this.domElement.style.display = \"none\";\r\n    });\r\n\r\n    this.saveButton = document.createElement(\"button\");\r\n    this.saveButton.textContent = \"Save\";\r\n    this.domElement.appendChild(this.saveButton);\r\n    this.saveButton.addEventListener(\"click\", () => {\r\n      this.onsave(this.note!);\r\n    });\r\n  }\r\n\r\n  override show(x: number, y: number, note: GridItem) {\r\n    super.show(x, y, note);\r\n    this.note = note;\r\n    this.domElement.parentElement?.appendChild(this.domElement);\r\n  }\r\n}\r\n\r\nexport class LyricEditorDialog extends PianoRollDialog {\r\n  textInput: HTMLInputElement;\r\n  audioCanvas: LyricCanvas;\r\n  pitchSlider: HTMLInputElement;\r\n  constructor(onsave: (note: GridItem) => void) {\r\n    super(onsave);\r\n    this.domElement.classList.add(\"piano-roll-note-editor\");\r\n    this.domElement.style.display = \"none\";\r\n\r\n    this.textInput = document.createElement(\"input\");\r\n    this.textInput.setAttribute(\"placeholder\", \"Note lyric\");\r\n    this.textInput.classList.add(\"lyric-editor-text\");\r\n    this.textInput.type = \"text\";\r\n    this.domElement.appendChild(this.textInput);\r\n\r\n    this.pitchSlider = document.createElement(\"input\");\r\n    this.pitchSlider.classList.add(\"lyric-editor-pitch\");\r\n    this.pitchSlider.type = \"range\";\r\n    this.pitchSlider.min = \"-0.5\";\r\n    this.pitchSlider.max = \"0.5\";\r\n    this.pitchSlider.step = \"0.01\";\r\n    this.pitchSlider.value = \"0\";\r\n    this.pitchSlider.addEventListener(\"input\", () => {\r\n      this.note!.note = parseFloat(this.pitchSlider.value);\r\n    });\r\n    this.domElement.appendChild(this.pitchSlider);\r\n\r\n    this.audioCanvas = new LyricCanvas();\r\n    this.domElement.appendChild(this.audioCanvas.domElement);\r\n\r\n    this.saveButton.addEventListener(\"click\", () => {\r\n      this.audioCanvas.domElement.style.display = \"block\";\r\n      this.audioCanvas.generateAudio(this.note!, true).then((buffer) => {\r\n        this.note!.audio = buffer;\r\n      });\r\n      this.onsave(this.note!);\r\n    });\r\n  }\r\n\r\n  show(x: number, y: number, note: GridItem) {\r\n    super.show(x, y, note);\r\n    this.textInput.value = this.note?.label || \"\";\r\n    if (this.note?.audio) {\r\n      this.audioCanvas.loadBuffer(this.note.audio);\r\n      this.audioCanvas.domElement.style.display = \"block\";\r\n    } else {\r\n      this.audioCanvas.domElement.style.display = \"none\";\r\n    }\r\n  }\r\n}\r\n","import EventObject from \"../../../../elements/src/EventObject\";\r\nimport {\r\n  DEFAULT_NOTE_HEIGHT,\r\n  NOTE_NAMES,\r\n} from \"../../../../elements/src/constants/audioConstants\";\r\nimport { PatternTrack } from \"./PatternTrack\";\r\nimport { LyricEditorDialog } from \"../audioDialogs\";\r\nimport { IEventItem } from \"../../schema\";\r\n\r\nfunction getNoteNameFromPitch(pitch: number): string {\r\n  const note = NOTE_NAMES[pitch % NOTE_NAMES.length];\r\n  return `${note}${Math.floor(pitch / NOTE_NAMES.length)}`;\r\n}\r\n\r\nconst NOTE_HANDLE_WIDTH = 6;\r\n\r\nexport class GridItem {\r\n  note: number;\r\n  start: number;\r\n  duration: number;\r\n  velocity: number = 100;\r\n  label: string | \"\" = \"\";\r\n  domElement: HTMLDivElement;\r\n  noteLabel: HTMLDivElement;\r\n  lyricLabel: HTMLDivElement;\r\n  audio: AudioBuffer | null = null;\r\n\r\n  constructor(\r\n    private readonly grid: Grid,\r\n    item: IEventItem\r\n  ) {\r\n    this.note = item.note;\r\n    this.start = item.start;\r\n    this.duration = item.duration;\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"piano-roll-note\");\r\n    this.domElement.style.height = `${grid.noteHeight}px`;\r\n\r\n    this.noteLabel = document.createElement(\"div\");\r\n    this.noteLabel.classList.add(\"piano-roll-note-label\");\r\n    this.noteLabel.textContent = getNoteNameFromPitch(this.note);\r\n    this.domElement.appendChild(this.noteLabel);\r\n\r\n    this.lyricLabel = document.createElement(\"div\");\r\n    this.lyricLabel.classList.add(\"piano-roll-note-lyric\");\r\n    this.domElement.appendChild(this.lyricLabel);\r\n\r\n    if (item.label) this.lyricLabel.textContent = item.label;\r\n\r\n    console.log(\"GridItem\", this);\r\n\r\n    grid.gridElement.appendChild(this.domElement);\r\n  }\r\n}\r\n\r\nexport class Grid extends EventObject<\"update\"> {\r\n  readonly domElement: HTMLDivElement;\r\n  readonly gridElement: HTMLDivElement;\r\n  readonly previewCanvas: HTMLCanvasElement;\r\n  readonly noteHeight = DEFAULT_NOTE_HEIGHT;\r\n  readonly beatWidth = 100;\r\n  readonly noteEditor: LyricEditorDialog;\r\n  private _currentNote: GridItem | null = null;\r\n  private _dragMode: string | null = null;\r\n  private _quantize: number = 0.25;\r\n  private _dragOffset: number = 0;\r\n  private _track: PatternTrack | null = null;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"piano-roll-grid-container\");\r\n\r\n    this.gridElement = document.createElement(\"div\");\r\n    this.gridElement.classList.add(\"piano-roll-grid\");\r\n\r\n    this.previewCanvas = document.createElement(\"canvas\");\r\n    this.previewCanvas.style.imageRendering = \"pixelated\";\r\n\r\n    const rowBackgroundCanvas = document.createElement(\"canvas\");\r\n    rowBackgroundCanvas.style.imageRendering = \"pixelated\";\r\n    rowBackgroundCanvas.width = this.beatWidth * 4;\r\n    rowBackgroundCanvas.height = this.noteHeight;\r\n    console.log(\"debug\", rowBackgroundCanvas.width, rowBackgroundCanvas.height);\r\n    const ctx = rowBackgroundCanvas.getContext(\"2d\");\r\n    // disable anti-alias\r\n\r\n    if (ctx) {\r\n      ctx.strokeStyle = \"#666\";\r\n      ctx.lineWidth = 0.5;\r\n      for (let j = 1; j < 4; j++) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(j * this.beatWidth, 0);\r\n        ctx.lineTo(j * this.beatWidth, this.noteHeight);\r\n        ctx.stroke();\r\n      }\r\n      ctx.lineWidth = 1;\r\n      ctx.strokeStyle = \"white\";\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(0, this.noteHeight);\r\n      ctx.stroke();\r\n    }\r\n    for (let i = 0; i < 88; i++) {\r\n      const row = document.createElement(\"div\");\r\n      row.classList.add(\"piano-roll-grid-row\");\r\n      row.style.height = `${this.noteHeight}px`;\r\n      this.gridElement.appendChild(row);\r\n      const base64 = rowBackgroundCanvas.toDataURL();\r\n      row.style.backgroundImage = `url(${base64})`;\r\n      row.style.backgroundRepeat = \"repeat\";\r\n    }\r\n    this.domElement.appendChild(this.gridElement);\r\n\r\n    this.noteEditor = new LyricEditorDialog((note) => {\r\n      const input = this.noteEditor.domElement.querySelector(\r\n        \".lyric-editor-text\"\r\n      ) as HTMLInputElement;\r\n      note.label = input?.value || \"\";\r\n    });\r\n\r\n    document.body.appendChild(this.noteEditor.domElement);\r\n\r\n    this.gridElement.addEventListener(\"pointerdown\", (event) => {\r\n      if (!this._track) throw new Error(\"No track\");\r\n\r\n      if (!this._track.events) throw new Error(\"No events\");\r\n\r\n      this._dragOffset = event.layerX;\r\n      event.preventDefault();\r\n      if (this.noteEditor.domElement.style.display === \"block\") {\r\n        this.noteEditor.domElement.style.display = \"none\";\r\n        return;\r\n      }\r\n\r\n      if (\r\n        event.target instanceof HTMLDivElement &&\r\n        event.target.classList.contains(\"piano-roll-note\")\r\n      ) {\r\n        this.gridElement.classList.add(\"dragging\");\r\n        const note = this._track.events.find(\r\n          (n) => n.domElement === event.target\r\n        );\r\n\r\n        if (event.ctrlKey || event.button === 1) {\r\n          if (note)\r\n            this.noteEditor.show(event.clientX + 20, event.clientY - 5, note);\r\n          else this.noteEditor.domElement.style.display = \"none\";\r\n        }\r\n\r\n        if (note) {\r\n          this._currentNote = note;\r\n\r\n          if (event.button === 2) {\r\n            this.remove(note);\r\n            this._currentNote = null;\r\n          } else {\r\n            note.domElement.parentElement?.appendChild(note.domElement);\r\n            if (this._dragOffset < NOTE_HANDLE_WIDTH) {\r\n              this._dragMode = \"start\";\r\n            } else if (\r\n              note.domElement.offsetWidth - this._dragOffset <\r\n              NOTE_HANDLE_WIDTH\r\n            ) {\r\n              this._dragMode = \"end\";\r\n            } else {\r\n              this._dragMode = \"move\";\r\n            }\r\n          }\r\n        }\r\n      } else if (event.button !== 0) return;\r\n      else if (event.target === this.gridElement) {\r\n        this.gridElement.classList.add(\"dragging\");\r\n        const pitch = 87 - Math.floor(event.layerY / this.noteHeight);\r\n\r\n        let start = event.layerX / this.beatWidth;\r\n        start = Math.round(start / this._quantize) * this._quantize;\r\n        console.log(\"start\", start, event.layerX);\r\n\r\n        const item = {\r\n          note: pitch,\r\n          start: start,\r\n          velocity: 100,\r\n          duration: 0.25,\r\n          label: \"\",\r\n        };\r\n\r\n        this._currentNote = this.add(new GridItem(this, item));\r\n        this._currentNote.domElement.style.top = `${\r\n          (87 - this._currentNote.note) * this.noteHeight\r\n        }px`;\r\n        this._currentNote.domElement.style.left = `${\r\n          this._currentNote.start * this.beatWidth\r\n        }px`;\r\n        this._dragMode = \"end\";\r\n      }\r\n\r\n      this.fireEvent(\"update\", this);\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"pointerup\", () => {\r\n      this.gridElement.classList.remove(\"dragging\");\r\n      this._currentNote = null;\r\n\r\n      this.fireEvent(\"update\", this);\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"pointerleave\", () => {\r\n      this.gridElement.classList.remove(\"dragging\");\r\n      if (this._currentNote) {\r\n        this.remove(this._currentNote);\r\n        this._currentNote = null;\r\n      }\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"contextmenu\", (event) => {\r\n      event.preventDefault();\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"pointermove\", (event) => {\r\n      if (this._currentNote && event.buttons === 1) {\r\n        if (this._dragMode === \"start\") {\r\n          const oldStart = this._currentNote.start;\r\n          this._currentNote.start = event.layerX / this.beatWidth;\r\n          this._currentNote.start =\r\n            Math.round(this._currentNote.start / this._quantize) *\r\n            this._quantize;\r\n          this._currentNote.duration =\r\n            oldStart - this._currentNote.start + this._currentNote.duration;\r\n          this._currentNote.domElement.style.left = `${\r\n            this._currentNote.start * this.beatWidth\r\n          }px`;\r\n          this._currentNote.domElement.style.width = `${\r\n            this._currentNote.duration * this.beatWidth\r\n          }px`;\r\n        } else if (this._dragMode === \"end\") {\r\n          this._currentNote.duration =\r\n            event.layerX / this.beatWidth - this._currentNote.start;\r\n\r\n          // quantize\r\n          this._currentNote.duration =\r\n            Math.round(this._currentNote.duration / this._quantize) *\r\n            this._quantize;\r\n\r\n          this._currentNote.domElement.style.width = `${\r\n            this._currentNote.duration * this.beatWidth\r\n          }px`;\r\n        } else if (this._dragMode === \"move\") {\r\n          this._currentNote.start =\r\n            (event.layerX - this._dragOffset) / this.beatWidth;\r\n          this._currentNote.start =\r\n            Math.round(this._currentNote.start / this._quantize) *\r\n            this._quantize;\r\n          this._currentNote.domElement.style.left = `${\r\n            this._currentNote.start * this.beatWidth\r\n          }px`;\r\n        } else {\r\n          return;\r\n        }\r\n\r\n        this.fireEvent(\"update\", this);\r\n      }\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"pointerup\", () => {\r\n      this.gridElement.classList.remove(\"dragging\");\r\n      if (this._currentNote) {\r\n        this._currentNote.domElement.style.pointerEvents = \"auto\";\r\n      }\r\n      this._currentNote = null;\r\n    });\r\n\r\n    this.gridElement.addEventListener(\"pointerleave\", () => {\r\n      this.gridElement.classList.remove(\"dragging\");\r\n      if (this._currentNote) {\r\n        this._currentNote.domElement.style.pointerEvents = \"auto\";\r\n      }\r\n      this._currentNote = null;\r\n    });\r\n  }\r\n\r\n  add(event: GridItem) {\r\n    if (!this._track) throw new Error(\"add() No track!\");\r\n    this._track.events.push(event);\r\n    console.log(\"Grid: add\", event);\r\n    return event;\r\n  }\r\n\r\n  remove(event: GridItem) {\r\n    if (!this._track) throw new Error(\"remove() No track!\");\r\n    this._track.events.splice(this._track.events.indexOf(event), 1);\r\n    this.gridElement.removeChild(event.domElement);\r\n  }\r\n\r\n  load(track: PatternTrack) {\r\n    console.log(\"Grid: load\", track.events);\r\n    this._track?.events.forEach((event) => event.domElement.remove());\r\n    this._track = track;\r\n    track.events.forEach((event) => {\r\n      this.gridElement.appendChild(event.domElement);\r\n    });\r\n  }\r\n\r\n  renderToCanvas(canvas: HTMLCanvasElement, color: string) {\r\n    if (!this._track) throw new Error(\"renderToCanvas() No track!\");\r\n\r\n    // find lowest note\r\n    let lowestNote = 88;\r\n    this._track.events.forEach((note) => {\r\n      if (note.note < lowestNote) lowestNote = note.note;\r\n    });\r\n\r\n    // find highest note\r\n    let highestNote = 0;\r\n    this._track.events.forEach((note) => {\r\n      if (note.note > highestNote) highestNote = note.note;\r\n    });\r\n\r\n    highestNote += 12;\r\n    lowestNote -= 12;\r\n\r\n    const ctx = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    let padded_scale = canvas.height / (highestNote - lowestNote + 1);\r\n\r\n    if (padded_scale > 2) {\r\n      padded_scale = 2;\r\n    }\r\n\r\n    this._track.events.forEach((note) => {\r\n      const y = canvas.height - (note.note - lowestNote + 1) * padded_scale;\r\n      const x = note.start * this.beatWidth;\r\n      const width = note.duration * this.beatWidth;\r\n      ctx.fillStyle = color;\r\n      ctx.fillRect(x, y, width, padded_scale);\r\n    });\r\n  }\r\n}\r\n","import {\r\n  DEFAULT_NOTE_HEIGHT,\r\n  KEY_COLORS,\r\n  NOTE_NAMES,\r\n} from \"../../../../elements/src/constants/audioConstants\";\r\n\r\nexport class SideKeyboard {\r\n  domElement: HTMLDivElement;\r\n  keys: HTMLDivElement[] = [];\r\n  noteHeight = DEFAULT_NOTE_HEIGHT;\r\n\r\n  constructor() {\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"piano-roll-keyboard\");\r\n\r\n    this.redraw();\r\n  }\r\n\r\n  redraw() {\r\n    this.domElement.innerHTML = \"\";\r\n\r\n    for (let i = 87; i >= 0; i--) {\r\n      const key = document.createElement(\"div\");\r\n      key.classList.add(\"piano-roll-keyboard-key\");\r\n      key.style.height = `${this.noteHeight}px`;\r\n      // key.style.bottom = `${i * this.noteHeight}px`;\r\n      key.style.backgroundColor =\r\n        KEY_COLORS[i % 12] === \"white\" ? \"#fff\" : \"#000\";\r\n      key.style.color = KEY_COLORS[i % 12] === \"white\" ? \"#000\" : \"#fff\";\r\n      key.textContent = NOTE_NAMES[i % 12] + ((i / 12) | 0).toString();\r\n      this.domElement.appendChild(key);\r\n    }\r\n  }\r\n}\r\n","import EventObject from \"../../../../elements/src/EventObject\";\r\nimport { getAudioContext } from \"../../../../elements/src/managers/AudioManager\";\r\nimport { AudioClock } from \"./AudioClock\";\r\nimport { Grid } from \"./Grid\";\r\nimport { PatternTrack } from \"./PatternTrack\";\r\nimport { SideKeyboard } from \"./SideKeyboard\";\r\n\r\nexport class PianoRoll extends EventObject<\"update\"> {\r\n  domElement: HTMLDivElement;\r\n  grid: Grid;\r\n  sideKeyboard: SideKeyboard;\r\n  cursor: HTMLDivElement;\r\n  cursorUpdateInterval: number | object | null = null;\r\n  scheduledSources: AudioBufferSourceNode[] = [];\r\n  track: PatternTrack | null = null;\r\n  color = \"#7979ce\";\r\n\r\n  constructor(private readonly clock: AudioClock) {\r\n    super();\r\n\r\n    this.domElement = document.createElement(\"div\");\r\n    this.domElement.classList.add(\"piano-roll\");\r\n\r\n    this.sideKeyboard = new SideKeyboard();\r\n    this.domElement.appendChild(this.sideKeyboard.domElement);\r\n\r\n    this.grid = new Grid();\r\n    this.domElement.appendChild(this.grid.domElement);\r\n    this.grid.on(\"update\", () => {\r\n      if (this.track) {\r\n        this.grid.renderToCanvas(this.track.canvas, this.color);\r\n      }\r\n      this.fireEvent(\"update\", this);\r\n    });\r\n\r\n    this.cursor = document.createElement(\"div\");\r\n    this.cursor.classList.add(\"piano-roll-cursor\");\r\n    this.grid.domElement.appendChild(this.cursor);\r\n\r\n    clock.on(\"start\", () => {\r\n      if (this.cursorUpdateInterval) {\r\n        clearInterval(this.cursorUpdateInterval as number);\r\n      }\r\n      this.cursor.style.transform = \"translateX(0)\";\r\n      this.cursor.style.display = \"block\";\r\n      this.cursor.parentElement?.appendChild(this.cursor);\r\n      this.scheduleAudioEvents();\r\n    });\r\n\r\n    clock.on(\"update\", () => {\r\n      this.updateCursor();\r\n    });\r\n\r\n    clock.on(\"stop\", () => {\r\n      this.cursor.style.display = \"none\";\r\n      this.scheduledSources.forEach((source) => source.stop());\r\n      this.scheduledSources = [];\r\n    });\r\n  }\r\n\r\n  updateCursor() {\r\n    if (this.clock.isPlaying) {\r\n      this.cursor.style.transform = `translateX(${\r\n        this.clock.currentBeat * this.grid.beatWidth\r\n      }px)`;\r\n    }\r\n  }\r\n\r\n  scheduleAudioEvents() {\r\n    const ctx = getAudioContext();\r\n    this.track?.events.forEach((note) => {\r\n      const bufferSource = ctx.createBufferSource();\r\n      bufferSource.buffer = note.audio;\r\n      bufferSource.connect(ctx.destination);\r\n      bufferSource.start(ctx.currentTime + (note.start * 60) / this.clock.bpm);\r\n      this.scheduledSources.push(bufferSource);\r\n    });\r\n  }\r\n\r\n  load(track: PatternTrack) {\r\n    this.track = track;\r\n    this.grid.load(track);\r\n  }\r\n}\r\n","import { DraggableWindow } from \"../../../../elements/src/elements/DraggableWindow\";\r\nimport { AudioClock } from \"../components/AudioClock\";\r\nimport { PatternTrack } from \"../components/PatternTrack\";\r\nimport { PianoRoll } from \"../components/PianoRoll\";\r\n\r\nexport class PianoRollWindow extends DraggableWindow<\"update\"> {\r\n  pianoRoll: PianoRoll;\r\n\r\n  constructor(readonly clock: AudioClock) {\r\n    const pianoRoll = new PianoRoll(clock);\r\n\r\n    super(\"Piano Roll\", true, pianoRoll.domElement);\r\n    this.pianoRoll = pianoRoll;\r\n\r\n    this.setSize(800, 400);\r\n  }\r\n\r\n  loadTrack(track: PatternTrack) {\r\n    this.pianoRoll.load(track);\r\n  }\r\n}\r\n","import { AudioClock } from \"./elements/components/AudioClock\";\r\nimport { WindowContainer } from \"../../elements/src/elements/WindowContainer\";\r\nimport { PatternWindow } from \"./elements/windows/PatternWindow\";\r\nimport { PlaylistWindow } from \"./elements/windows/PlaylistWindow\";\r\nimport { Composition } from \"./elements/Composition\";\r\nimport { PatternTrack } from \"./elements/components/PatternTrack\";\r\nimport { PianoRollWindow } from \"./elements/windows/PianoRollWindow\";\r\n\r\nconst domElement = document.createElement(\"div\");\r\ndomElement.style.display = \"flex\";\r\ndomElement.style.flexDirection = \"column\";\r\ndomElement.style.width = \"100%\";\r\ndomElement.style.height = \"100%\";\r\n\r\nconst audioClock = new AudioClock();\r\ndomElement.appendChild(audioClock.domElement);\r\n\r\nconst container = new WindowContainer();\r\ndomElement.appendChild(container.domElement);\r\n\r\nconst composition = new Composition();\r\n\r\nconst pianoRollWindow = new PianoRollWindow(audioClock);\r\n\r\ncontainer.addWindow(pianoRollWindow);\r\npianoRollWindow.setSize(800, 400);\r\n\r\npianoRollWindow.setPosition(window.innerWidth / 2, 100);\r\n\r\nconst patternWindow = new PatternWindow(audioClock, composition);\r\npianoRollWindow.loadTrack(patternWindow.addTrack(\"Kick\"));\r\npatternWindow.addTrack(\"Snare\");\r\npatternWindow.addTrack(\"Hats\");\r\npatternWindow.addTrack(\"Bass\");\r\npatternWindow.addTrack(\"Lead\");\r\npatternWindow.show(100, 100);\r\ncontainer.addWindow(patternWindow);\r\n\r\npatternWindow.on(\"select\", (selectedTrack) => {\r\n  console.log(\"select\", selectedTrack);\r\n  pianoRollWindow.loadTrack(selectedTrack as PatternTrack);\r\n  pianoRollWindow.show();\r\n});\r\n\r\nconst playlistWindow = new PlaylistWindow(audioClock, composition);\r\nfor (let i = 1; i <= 9; i++) {\r\n  playlistWindow.addTrack(`Pattern ${i}`);\r\n}\r\ncontainer.addWindow(playlistWindow);\r\n// playlistWindow.show(600, 100);\r\n\r\ndocument.body.appendChild(domElement);\r\n\r\nconsole.log(\"Serialized\", composition.serialize());\r\n"],"names":["exports","Symbol","toStringTag","Object","defineProperty","value","_events","_onceEvents","on","eventName","callback","this","push","once","fireEvent","eventData","onceCallbacks","error","console","undefined","callbacks","audioContext","getAudioContext","window","AudioContext","webkitAudioContext","log","buffer","createBuffer","sampleRate","source","createBufferSource","connect","destination","start","_isPlaying","_bpm","startTime","domElement","document","createElement","classList","add","playPauseButton","textContent","addEventListener","stop","play","appendChild","stopButton","bpmInput","type","parseFloat","currentTimeDisplay","currentTime","requestAnimationFrame","render","bind","updateCurrentTimeDisplay","currentBeat","beat","bars","Math","floor","beats","timeString","toString","padStart","windows","_draggingWindow","className","addWindow","tagName","_resizing","_startX","_startY","_startWidth","_startHeight","_startTop","_startLeft","_resizeDirection","e","handle","getCurrentHandle","style","cursor","onmove","dx","clientX","dy","clientY","width","height","left","top","offsetWidth","offsetHeight","preventDefault","startResize","onrelease","stopResize","removeEventListener","direction","offsetTop","offsetLeft","rect","getBoundingClientRect","offsetX","offsetY","BaseElement","title","persistent","innerContent","_isDragging","_dragOffsetX","_dragOffsetY","_top","_left","parentElement","titlebar","scrollTop","ondrag","newTop","newLeft","body","_title","content","_closeButton","innerHTML","close","display","show","x","y","setTimeout","remove","setSize","setPosition","setTitle","SizableElement","audioClock","container","update","name","events","_name","instrumentPanel","label","buttons","edit","mute","solo","indicator","_canvas","composition","tracks","timeline","AudioCursor","addTrack","track","PatternTrack","selectedTrack","removeTrack","index","indexOf","splice","removeChild","DraggableWindow","settings","clock","_tracks","_trackContainer","updateCursor","PlaylistTrack","isPlaying","transform","patterns","description","tempo","serialize","JSON","stringify","KEY_COLORS","NOTE_NAMES","canvas","playBuffer","ctx","getContext","generateAudio","note","preview","Promise","resolve","reject","req","text","pitch","rate","fetch","method","headers","then","res","arrayBuffer","data","decodeAudioData","audioBuffer","catch","loadBuffer","channelData","getChannelData","bufferLength","length","sliceWidth","clearRect","beginPath","moveTo","i","lineTo","stroke","AudioCanvas","ok","cancel","closeButton","HTMLButtonElement","okButton","cancelButton","targetObject","hide","onsave","textInput","setAttribute","pitchSlider","min","max","step","audioCanvas","LyricCanvas","saveButton","audio","DialogPopup","grid","item","velocity","duration","noteHeight","noteLabel","lyricLabel","gridElement","beatWidth","_currentNote","_dragMode","_quantize","_dragOffset","_track","previewCanvas","imageRendering","rowBackgroundCanvas","strokeStyle","lineWidth","j","row","base64","toDataURL","backgroundImage","backgroundRepeat","noteEditor","LyricEditorDialog","input","querySelector","event","Error","layerX","target","HTMLDivElement","contains","find","n","ctrlKey","button","layerY","round","GridItem","oldStart","pointerEvents","load","forEach","renderToCanvas","color","lowestNote","highestNote","padded_scale","fillStyle","fillRect","keys","redraw","key","backgroundColor","cursorUpdateInterval","scheduledSources","sideKeyboard","SideKeyboard","Grid","clearInterval","scheduleAudioEvents","bufferSource","bpm","pianoRoll","PianoRoll","loadTrack","flexDirection","AudioClock","WindowContainer","Composition","pianoRollWindow","PianoRollWindow","innerWidth","patternWindow","PatternWindow","playlistWindow","PlaylistWindow"],"sourceRoot":""}